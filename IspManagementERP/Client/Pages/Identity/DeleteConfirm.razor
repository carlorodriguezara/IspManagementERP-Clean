@namespace IspManagementERP.Client.Shared

<div class="@ModalClass" tabindex="-1" style="display:@(Visible ? "block" : "none")">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-body">
                <p>@Message</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" @onclick="Cancel">Cancelar</button>
                <button class="btn btn-danger" @onclick="Confirm">Borrar</button>
            </div>
        </div>
    </div>
</div>

@code {
    private bool Visible;
    private string Message = "¿Confirmar?";
    public EventCallback<bool> OnResult { get; set; }
    private string ModalClass => Visible ? "modal fade show d-block" : "modal fade";

    public Task<bool> ShowAsync(string message)
    {
        Message = message;
        Visible = true;
        StateHasChanged();
        var tcs = new TaskCompletionSource<bool>();
        OnResult = EventCallback.Factory.Create<bool>(this, (bool r) => { tcs.SetResult(r); return Task.CompletedTask; });
        return tcs.Task;
    }

    private async Task Confirm()
    {
        Visible = false;
        await OnResult.InvokeAsync(true);
    }
    private async Task Cancel()
    {
        Visible = false;
        await OnResult.InvokeAsync(false);
    }
}